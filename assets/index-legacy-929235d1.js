System.register(["./index-legacy-66aa927d.js","./index-legacy-1eab1b9b.js"],(function(e,a){"use strict";var t,n,o,l,i,c,r,d,s,u,m,p,v,g,f,h,y,x,b,_,k,w,U;return{setters:[e=>{t=e._,n=e.u,o=e.r,l=e.B,i=e.a,c=e.o,r=e.c,d=e.b,s=e.w,u=e.e,m=e.x,p=e.z,v=e.F,g=e.g,f=e.h,h=e.v,y=e.d,x=e.A,b=e.H,_=e.E,k=e.p,w=e.l},e=>{U=e.s}],execute:function(){var C=document.createElement("style");C.textContent=".common-layout .el-dialog__body{padding-top:0!important}.common-layout[data-v-700f6164]{background:#ededef}.common-layout .el-header h2[data-v-700f6164]{padding-left:35px;font-size:20px;font-weight:700;background:white;margin:0;height:62px;line-height:62px}.common-layout .el-container .el-container[data-v-700f6164]{padding:20px}.common-layout .el-container .el-container .el-aside[data-v-700f6164]{display:flex;flex-direction:column}.common-layout .el-container .el-container .el-aside .el-button[data-v-700f6164]{margin:0 0 12px 12px}.common-layout .el-container .el-container .el-main[data-v-700f6164]{display:flex;justify-content:space-between}.common-layout .el-container .el-container .el-main h3[data-v-700f6164]{margin:0 0 10px;text-align:center}.common-layout .el-container .el-container .el-main canvas[data-v-700f6164],.common-layout .el-container .el-container .el-main video[data-v-700f6164]{flex:1;height:80%;background:url("+new URL("empty-5069de63.png",a.meta.url).href+") no-repeat center center}.common-layout .el-container .el-container .el-main canvas[data-v-700f6164]{margin-left:30px}\n",document.head.appendChild(C);const M=e=>(k("data-v-700f6164"),e=e(),w(),e),j={class:"common-layout"},O=M((()=>y("h2",null,"摄像头",-1))),$=M((()=>y("h3",null,"选定图片区",-1))),D={ref:"canvas",width:"640",height:"480"},E=M((()=>y("h3",null,"拍摄区",-1))),T={ref:"video",width:"640",height:"480",autoplay:""},z=t({__name:"Camera",setup(e){const a=n(),t=o([]),k=o(!1),w=o(!0),C=o(""),{proxy:M}=x();l((()=>{G()}));const z=()=>{navigator.mediaDevices.getUserMedia({video:!0}).then((e=>{M.$refs.video.srcObject=e,M.$refs.video.play(),k.value=!0})).catch((e=>{b({message:"摄像头开启失败，请检查是否开启权限",type:"warning"})}))},A=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0});if(C.value=e.id,e){M.$refs.canvas.getContext("2d").drawImage(M.$refs.video,0,0,640,480);let e=M.$refs.canvas.toDataURL("image/jpeg",.7),a=L(e,"摄像头拍摄"),t=new FormData;t.append("files",a),t.append("module",113),U({url:"http://localhost:81/dev-api/common/uploadMore",method:"post",data:t})}}catch(e){b({message:"摄像头开启失败，请检查是否开启权限",type:"warning"});const a=navigator.userAgent;a.indexOf("Chrome")>-1?console.log("chrome://settings/content/camera"):a.indexOf("Firefox")>-1?console.log("firefox://settings/content/camera"):a.indexOf("Safari")>-1?console.log("safari://settings/content/camera"):a.indexOf("Opera")>-1?console.log("opera://settings/content/camera"):a.indexOf("Edge")>-1?console.log("edge://settings/content/camera"):console.log("无法识别的浏览器")}},F=()=>{C.value?_.prompt("请输入此文件的名字","Tip",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:e})=>{let a=document.createElement("a");a.href=M.$refs.canvas.toDataURL("image/jpg",.7),a.download=e+".jpeg",a.click(),b({type:"success",message:"下载成功"})})):b({message:"请进行拍照后再尝试下载",type:"warning"})},G=()=>{M.$refs.video.srcObject&&(M.$refs.video.srcObject.getTracks().forEach((e=>{e.stop(),k.value=!1})),M.$refs.video.srcObject=null)},I=()=>{navigator.mediaDevices.enumerateDevices().then((e=>{t.value=[],e.forEach((e=>{"videoinput"==e.kind&&t.value.push({label:e.label,id:e.deviceId})}))})).catch((function(e){console.log(e)}))},B=(e,a,t)=>{navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(e).then((e=>{M.$refs.video.srcObject=e,M.$refs.video.play()})).catch(t):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(e,a,t):navigator.mozGetUserMedia?navigator.mozGetUserMedia(e,a,t):navigator.getUserMedia&&navigator.getUserMedia(e,a,t)},L=(e,a)=>{let t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=atob(t[1]),l=o.length,i=new Uint8Array(l);for(;l--;)i[l]=o.charCodeAt(l);return new File([i],a,{type:n})};I();const R=()=>{console.log(1),a.push({name:"Home"})};return(e,a)=>{const n=i("el-header"),o=i("el-button"),l=i("el-divider"),x=i("el-link"),b=i("el-tooltip"),_=i("el-aside"),U=i("el-main"),C=i("el-container"),M=i("el-dialog");return c(),r("div",j,[d(M,{width:"80%",modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),title:"Tips","lock-scroll":"","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":R},{default:s((()=>[d(C,null,{default:s((()=>[d(n,null,{default:s((()=>[O])),_:1}),d(C,null,{default:s((()=>[d(_,{width:"200px"},{default:s((()=>[d(o,{onClick:z,type:"primary",plain:""},{default:s((()=>[u("开启摄像头")])),_:1}),d(o,{onClick:I,type:"primary",plain:"",disabled:""},{default:s((()=>[u("切换摄像头")])),_:1}),d(o,{onClick:G,type:"primary",plain:""},{default:s((()=>[u("关闭摄像头")])),_:1}),m(d(o,{type:"primary",onClick:A,plain:""},{default:s((()=>[u("拍照")])),_:1},512),[[p,k.value]]),m(d(o,{type:"primary",onClick:F,plain:""},{default:s((()=>[u("下载")])),_:1},512),[[p,k.value]]),d(l),(c(!0),r(v,null,g(t.value,(e=>(c(),f(b,{class:"box-item",effect:"dark",content:e.label,placement:"right-end",key:e.id},{default:s((()=>[d(x,{onClick:a=>(e=>{const a={};""===e?a.facingMode="environment":(a.deviceId={exact:e},k.value=!0),B({video:a})})(e.id),underline:!1,class:"ovhd"},{default:s((()=>[u(h(e.label),1)])),_:2},1032,["onClick"])])),_:2},1032,["content"])))),128))])),_:1}),d(U,null,{default:s((()=>[y("div",null,[$,y("canvas",D,null,512)]),y("div",null,[E,y("video",T,null,512)])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-700f6164"]]);e("default",{__name:"index",setup:e=>(e,a)=>(c(),f(z))})}}}));
